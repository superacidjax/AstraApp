<div data-controller="people-rule-builder" data-people-rule-builder-traits-value="<%= @traits.to_json(only: [ :id, :name, :client_application_id ]) %>">
<div class="form-group">
    <label for="rule_name">Rule Name</label>
    <input type="text" id="rule_name" name="rule[name]" class="form-control">
  </div>

  <div class="form-group">
    <label for="client_applications">Client Application</label>
    <select id="client_applications" name="rule[client_application_ids][]" 
      class="form-control" multiple 
      data-people-rule-builder-target="clientApplications" 
      data-action="change->people-rule-builder#filterTraits">
      <option value="all">All Applications</option>
      <% client_applications.each do |client_app| %>
        <option value="<%= client_app.id %>">
          <%= client_app.name %>
        </option>
      <% end %>
    </select>
  </div>

  <div class="form-group">
    <label for="traits">Trait</label>
    <select id="traits" name="rule[trait_id]" class="form-control" 
      data-people-rule-builder-target="traitSelector">
      <option value="">Select a trait</option>
      <% traits.each do |trait| %>
        <option value="<%= trait.id %>" data-client-application-id="<%= trait.client_application_id %>">
          <%= trait.name %>
        </option>
      <% end %>
    </select>
  </div>

  <button type="submit" class="btn btn-primary">Save Rule</button>
</div>
